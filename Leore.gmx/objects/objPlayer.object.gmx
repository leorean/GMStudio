<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>mskPlayer</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>0</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_speed = 0;
depth = PLAYERDEPTH;

global.player = id;

xPrev = x;
yPrev = y;

colL = false;
colR = false;
colU = false;
colD = false;

xVel = 0;
xVelMax = 2;
yVel = 0;
xAcc = .1;
yGrav = .15;
yJump = 3.2;

isJumped = false;

state = IDLE;
statePrev = state;

//+++animation
w = abs(bbox_left - bbox_right);
h = abs(bbox_top - bbox_bottom);

dir = RIGHT;

frame = 0;
row = 0;
fSpeed = 0;
fMax = 3;
fCur = 0;

target = noone; //tower
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//++++input
if (global.hasControl)
{
    keyL = keyboard_check(vk_left);
    keyLPressed = keyboard_check_pressed(vk_left);
    keyLReleased = keyboard_check_released(vk_left);
    keyR = keyboard_check(vk_right);
    keyRPressed = keyboard_check_pressed(vk_right);
    keyRReleased = keyboard_check_released(vk_right);
    keyU = keyboard_check(vk_up);
    keyUPressed = keyboard_check_pressed(vk_up);
    keyUReleased = keyboard_check_released(vk_up);
    keyD = keyboard_check(vk_down);
    keyDPressed = keyboard_check_pressed(vk_down);
    keyDReleased = keyboard_check_released(vk_down);
}
else
{
    keyL = false;
    keyLPressed = false;
    keyLReleased = false;
    keyR = false;
    keyRPressed = false;
    keyRReleased = false;
    keyU = false;
    keyUPressed = false;
    keyUReleased = false;
    keyD = false;
    keyDPressed = false;
    keyDReleased = false;
}

//++++level bounds
if (bbox_left &lt;= 0) {xVel = 0; x += .1;}
if (bbox_right &gt;= room_width) {xVel = 0; x -= .1;}



//++++flag control
prePhysics();

//++++movement
if (state == IDLE || state == JUMP || state == RUN)
{
    if (keyL &amp;&amp; !keyR)
    {
        xVel = max(xVel - xAcc, -xVelMax);
        if (onGround) state = RUN;
    }
    
    if (keyR &amp;&amp; !keyL)
    {
        xVel = min(xVel + xAcc, xVelMax);
        if (onGround) state = RUN;
    }

    if (keyL &amp;&amp; xVel &lt; 0)
    {
        dir = LEFT;
    }
    if (keyR &amp;&amp; xVel &gt; 0)
    {
        dir = RIGHT;
    }
    if (keyL || keyR)
    {
        if (onGround)
            state = RUN;
        else
            state = JUMP;
    }
    
    if (!keyL &amp;&amp; !keyR &amp;&amp; onGround)
    {
        fricPhysics();
        if (xVel == 0)
            state = IDLE;
        else
            state = RUN;
    }
}

//++++jumping
if (state != ATTACK)
{
    if (keyUPressed)
    {
        if (!isJumped)
        {
            yVel = -yJump;
            isJumped = true;
            state = JUMP;
        }
    }
}

show_debug_message(target);

if (target == noone &amp;&amp; instance_number(objTower) &gt; 0)
    target = instance_place(x,y,objTower);

if (instance_exists(target))
{
    if (!place_meeting(x,y,target))
        target = noone;
} else
    target = noone;
    
if (global.keyAction &amp;&amp; onGround &amp;&amp; !instance_exists(objTowerMenu))
{
    xVel = 0;
    yVel = 0;
    global.hasControl = false;
    var tm;
    tm = instance_create(0,0,objTowerMenu);
    tm.target = target;
}

doPhysics();

//++++ end routine
if (state != statePrev)
    fCur = 0;
statePrev = state;
xPrev = x;
yPrev = y;


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>draw_set_alpha(1);
draw_set_color(c_white);

fCur = (fCur + fSpeed) mod (fMax + 1);
frame = floor(fCur);

switch(state)
{
    case IDLE:
        fSpeed = .1;
        row = 0;
    break;
    case RUN:
        fSpeed = .2;
        row = 1;
    break;
    case JUMP:
        fSpeed = .1;
        row = 2;
    break;
    case DIE:
        
    break;
    case ATTACK:
        
    break;
    case HURT:
        
    break;
    
}

if (dir == RIGHT)
    draw_sprite_part(sprPlayer,-1,frame*TILE,row*TILE,TILE,TILE,floor(x-TILE/2),floor(y-TILE/2));
if (dir == LEFT)
    draw_sprite_part_ext(sprPlayer,-1,frame*TILE,row*TILE,TILE,TILE,floor(x+TILE/2),floor(y-TILE/2),-1,1,c_white,1);
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>2</PhysicsObjectShape>
  <PhysicsObjectDensity>10</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.100000001490116</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints>
    <point>0,0</point>
    <point>32,0</point>
    <point>32,32</point>
  </PhysicsShapePoints>
</object>
