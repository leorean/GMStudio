<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>2</depth>
  <persistent>0</persistent>
  <parentName>objAll</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>depth = HUDDEPTH+1;//+2;
index = 0;
maxIndex = 5;

canProceed = false;
shared = false;

initAD();


//"I'm Rich Achievement (incremental)
postAchievement("CgkIsq60qNAMEAIQCA",global.coinsCollected,true);

//Happy Carnage Achievement (incremental)
postAchievement("CgkIsq60qNAMEAIQBw",global.enemiesKilled,true);

//combo rookie achievement
if (global.maxCombo &gt;= 10)
    postAchievement("CgkIsq60qNAMEAIQDg",100,false);
//combo novice achievement
if (global.maxCombo &gt;= 50)
    postAchievement("CgkIsq60qNAMEAIQDw",100,false);
//combo expert achievement
if (global.maxCombo &gt;= 100)
    postAchievement("CgkIsq60qNAMEAIQEA",100,false);
//combo master achievement
if (global.maxCombo &gt;= 200)
    postAchievement("CgkIsq60qNAMEAIQEQ",100,false);

if (global.maxLevelReached &gt;= 20)
{
    if (global.playerLocked[2])
    {
        global.playerLocked[2] = false;
        saveProgress();
        loadProgress();
        show_message_async("Congratulations! You have unlocked a new character!");
    }
}

    
confetti = 0;

//if (global.maxLevelReached &gt;= 5)
//    postAchievement("CgkIsq60qNAMEAIQAQ",100);

//to show an icon if you can buy something new from shop
canBuySomething = false;

for (i = 0; i &lt; UPGRADE.SIZE; i+=1)
{
    var p;
    p = global.upgrade[i,UPGRADE.PRICE];
    if (!global.upgrade[i,UPGRADE.LOCKED]
    &amp;&amp; (global.upgrade[i,UPGRADE.TIER] &lt; array_length_1d(p)
    &amp;&amp; (p[global.upgrade[i,UPGRADE.TIER]] &lt;= global.wallet)))
        canBuySomething = true;
}

if (global.input != INPUT_TOUCH)
    global.mouseVisible = true;

finalScore = global.curScore;
submitted = false;
var r;
r = 2.5*TILE;
btn[0] = instance_create(WIDTH/2-4.5*TILE,r+1.5*TILE,objButton);
btn[0].text = "";//upgrade shop
btn[0].tooltip = "Upgrade Shop";
btn[0].index = 0;
btn[0].parent = id;
btn[0].drawBg = true;
btn[0].w = 1*TILE;
btn[0].img = 2;
if (canBuySomething) btn[0].new = true;

btn[1] = instance_create(WIDTH/2+4.5*TILE,r+1.5*TILE,objButton);
btn[1].text = "";//try again
btn[1].tooltip = "Try again";
btn[1].index = 1;
btn[1].parent = id;
btn[1].drawBg = true;
btn[1].w = 1*TILE;
btn[1].img = 6;

btn[2] = instance_create(WIDTH/2-9*TILE,r+4*TILE,objButton);
btn[2].text = "";//submit score
btn[2].tooltip = "Submit Score";
btn[2].index = 2;
btn[2].parent = id;
btn[2].drawBg = true;
btn[2].w = 1*TILE;
btn[2].img = 5;

btn[3] = instance_create(WIDTH/2-4.5*TILE,r+6.5*TILE,objButton);
btn[3].text = "";//achievements
btn[3].tooltip = "Achievements";
btn[3].index = 3;
btn[3].parent = id;
btn[3].drawBg = true;
btn[3].w = 1*TILE;
btn[3].img = 3;

btn[4] = instance_create(WIDTH/2+4.5*TILE,r+6.5*TILE,objButton);
btn[4].text = "";//quit
btn[4].tooltip = "Quit";
btn[4].index = 4;
btn[4].parent = id;
btn[4].drawBg = true;
btn[4].w = 1*TILE;
btn[4].img = 7;

btn[5] = instance_create(WIDTH/2+9*TILE,r+4*TILE,objButton);
btn[5].text = "";//share on fb

gift = min(max(floor(global.coinsCollected/10),5),500);

btn[5].tooltip = "Share Score# and get " + string(gift)+" Coins";
btn[5].index = 5;
btn[5].parent = id;
btn[5].drawBg = true;
btn[5].w = 1*TILE;
btn[5].img = 8;

for (i = 0; i &lt;= maxIndex; i++)
{
    btn[i].visible = false;
//    btn[i].depth = HUDDEPTH - 1;
}

//effect
dx = -2*TILE;
dxx = -WIDTH*.5;
dy = 1*TILE;
t = 0;
m = 0;

playSound(sfxRocketFall,1);

/*if (os_type != os_android)
    if (global.playthrough &gt; 2 &amp;&amp; global.playthrough mod 3 == 0)
        fgl_ad_show();
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="1" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>with (objButton)
    instance_destroy();
    

</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if (!global.gameOver || room != MAIN)
    instance_destroy();

if (canProceed)
{
    btn[0].visible = true;
    btn[1].visible = true;
    btn[2].visible = true;
    btn[3].visible = true;
    btn[4].visible = true;
    btn[5].visible = true;
    
    handleButtons();
    
    if (btn[0].pressed)
        room_goto(SHOP);
    if (btn[1].pressed)
        room_restart();
    if (!os_is_network_connected())
    {
        btn[2].enabled = false;
        btn[3].enabled = false;
        btn[5].enabled = false;
    
    }
    else
    {
        btn[2].enabled = true;
        btn[3].enabled = true;
        btn[5].enabled = true;
    
    }
    
    if (btn[2].pressed)
    {
        if(!achievement_login_status())
            achievement_login();
            
        if (achievement_available())
        {
            if (!submitted) // can only submit ONCE per run
            {
                achievement_post_score("CgkIsq60qNAMEAIQFg", finalScore);
                
                //Look at my Swag Achievement
                postAchievement("CgkIsq60qNAMEAIQCg",100,false);
                submitted = true;
            }            
            achievement_show_leaderboards();
        }
    }
    if (btn[3].pressed)
    {
        if(!achievement_login_status())
                achievement_login();
                
        if (achievement_available())
            achievement_show_achievements();        
    }
    
    if (btn[4].pressed)
        room_goto(INIT);
        
    if (btn[5].pressed)
    {
        if (!global.Auth)
        {
            if (!instance_exists(objFacebook))
                instance_create(0,0,objFacebook);
        }
        
        if (global.Auth)
        {
            wallPostMap = ds_map_create();//Create a ds_map that holds the details used to create the wall post
            ds_map_add(wallPostMap, "message", "Test");   //The content message of the post
            //ds_map_add(wallPostMap, "picture", "http://mcsweenygames.com/Clown.jpg");               //An image link that is to accompany the post
            ds_map_add(wallPostMap, "link", "http://shinypixelgames.com/");//The link that the "Name" will direct you to when clicked
            ds_map_add(wallPostMap, "name", "Happy Dash Test");//The post name
            ds_map_add(wallPostMap, "caption", "Test Caption");//The post caption
            ds_map_add(wallPostMap, "description", "Test Description!");//Post description
            facebook_dialog("feed", wallPostMap, -1);
            ds_map_destroy(wallPostMap);//Destroy the ds_grid
            
            if (!shared)
            {
                global.wallet += gift;
                saveProgress();
                loadProgress();
            }
            
            shared = true;
        }
    }
        
} else
{
    btn[0].visible = false;
    btn[1].visible = false;
    btn[2].visible = false;
    btn[3].visible = false;
    btn[4].visible = false;
    btn[5].visible = false;
    
}


</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>image_speed = 0;

draw_set_alpha((dx/WIDTH)*.75);
draw_set_color(c_black);
//with(objLiving) depth = objGameOverMenu.depth-1;
draw_rectangle(0,0,WIDTH,HEIGHT,0);

draw_set_font(global.fntDefault);
draw_set_color(c_white);
draw_set_alpha(1);
draw_set_halign(fa_center);
draw_set_valign(fa_top);

//rainbow effect
draw_set_alpha(.7);
for (i = 0; i &lt; TILE; i+=1)
{
    draw_set_color(make_color_hsv((i div 2)*22,255,255));
    draw_line_width(-2*TILE,dy+i,dx+TILE-abs(TILE/2-i),dy+i,1);
}
draw_set_alpha(1);
draw_set_color(c_white);

//player effect
if (dx &lt; WIDTH+2*TILE)
{
    dx = min(dx+8,WIDTH+2*TILE);
    draw_sprite_part(spritePlayer,-1,(floor(global.timer/3) mod 4)*2*TILE,6*TILE,2*TILE,2*TILE,dx-TILE/2,dy-TILE/2);
    if (global.timer mod 3 == 0)
    {
        e = instance_create(dx-TILE+random(2*TILE),dy-TILE+random(2*TILE),objEffectDust);
        e.type = 3;
        e.depth = depth-1;
        e.xVel = -1+random(2);
        e.yVel = -1+random(2);
    }
    
} else
{
    if (global.timer mod 2 == 0)
    {
        c = instance_create(random(WIDTH),-TILE,objEffectConfetti);
        c.parent = id;
        c.depth = depth-2;
    }
}

//score effect
if (dxx &lt; WIDTH*.5)
    dxx = min(dxx+4,WIDTH*.5);
else
{
    if (m &lt;5)
    {
        t +=1;
        if (t &gt; 5)
        {
            //playSound(sfxCaching,1);
            m+=1;
            t = 0;
        }
    } else
    if (global.timer mod 5 = 0)
    {
        t = instance_create(WIDTH*.5-4*TILE+random(8*TILE)-TILE/2,dy-TILE+random(2*TILE)-TILE/2,objEffectDust);
        t.type = 7;
        t.depth = depth-1;
    }
}

if (dxx &gt;= WIDTH*.5)
    canProceed = true;

var row,d;
row = 2.5;
d = 11*TILE;

draw_set_font(global.fntScore);
draw_text(min(dxx,WIDTH*.5), dy-.5*TILE,":"+string(finalScore)+":");

//if (canProceed)
//    drawBorder(7*TILE,3*TILE,11*TILE,9*TILE);


</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
