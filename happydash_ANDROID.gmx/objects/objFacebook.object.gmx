<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>0</depth>
  <persistent>-1</persistent>
  <parentName>&lt;undefined&gt;</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>facebook_init(); // Initialise Facebook
global.fbAuth = false; // Control variable

permissions = ds_list_create();
ds_list_add(permissions, "public_profile");
facebook_login(permissions, fb_login_default);
//ds_list_destroy(permissions);

alarm[0] = 0; //Set an alarm to check the login status
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>//Check the Facebook status and set a global variable
var fbStatus;
fbStatus = facebook_status();                                       // Get the Facebook status
show_debug_message( "facebook status: " + fbStatus);
switch (fbStatus)                                          
{
    case "AUTHORISED":                                                  //Facebook authorised!
        global.fbAuth = true;
        
        var request = "publish_actions";
        if (!facebook_check_permission(request))
        {
            var perm = ds_list_create();
            ds_list_add(perm, request);
            request_ID = facebook_request_publish_permissions(perm);
            ds_list_destroy(perm);
        }
        
        if (!global.shared)
        {
            wallPostMap = ds_map_create();//Create a ds_map that holds the details used to create the wall post
            ds_map_add(wallPostMap, "message", "Test");   //The content message of the post
            //ds_map_add(wallPostMap, "picture", "http://mcsweenygames.com/Clown.jpg");               //An image link that is to accompany the post
            ds_map_add(wallPostMap, "link", "http://shinypixelgames.com/");//The link that the "Name" will direct you to when clicked
            ds_map_add(wallPostMap, "name", "Happy Dash Test");//The post name
            ds_map_add(wallPostMap, "caption", "Test Caption");//The post caption
            ds_map_add(wallPostMap, "description", "Test Description!");//Post description
            facebook_dialog("feed", wallPostMap, -1);
            ds_map_destroy(wallPostMap);//Destroy the ds_grid
            
            global.wallet += gift;
            saveProgress();
            loadProgress();
            
            global.shared = true;
        }
        
        instance_destroy(); 
        break;   
    case "IDLE":                                                        //facebook initialised - ready to login  
        facebook_login(permissions, fb_login_default); 
        alarm[0] = 30; 
        break;   
    case "FAILED":                                                      //Failure in the connection, so try again...
        facebook_login(permissions, fb_login_default);  
        alarm[0] = 30; 
        break;   
    case "DENIED":                                                      //We have not granted permissions to our facebook app
        if (!global.AskedForLogin)
        {                                                           //login and ask for permissions if we have not already done so
            facebook_login(permissions, fb_login_default);
            alarm[0] = 30;      
        }
        else
            instance_destroy();                                         //Denied, probably because the user as not given permission.
        break;
        
    default: alarm[0] = 30;                                             //None of the above options, so repeat the alarm until we have a result
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
